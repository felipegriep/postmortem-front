<div class="w-full">
    <div class="mt-6">
        <header class="mb-4 flex items-center justify-between border-b pb-4 dark:border-gray-600">
            <div>
                <h2 class="text-xl md:text-2xl font-bold text-gray-800 dark:text-gray-100">Timeline do Incidente</h2>
                <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Registre eventos importantes relacionados a este incidente.</p>
            </div>
            <button (click)="openEventDialog()" class="btn-primary" type="button">
                <mat-icon>add</mat-icon>
                <span class="ml-2">Novo Evento</span>
            </button>
        </header>

        <div class="mat-elevation-z2 rounded-md overflow-hidden bg-white">
            <table mat-table [dataSource]="dataSource" class="min-w-full">
                <!-- Coluna Data/Hora -->
                <ng-container matColumnDef="eventAt">
                    <th mat-header-cell *matHeaderCellDef class="text-left"> DATA/HORA </th>
                    <td mat-cell *matCellDef="let element" class="py-3 px-4">
                        <span class="font-mono text-sm">{{ element.eventAt | date:'dd/MM/yy HH:mm' }}</span>
                    </td>
                </ng-container>

                <!-- Coluna Tipo -->
                <ng-container matColumnDef="type">
                    <th mat-header-cell *matHeaderCellDef class="text-left"> TIPO </th>
                    <td mat-cell *matCellDef="let element" class="py-3 px-4">
                        <span class="px-2 py-1 text-xs font-bold rounded-full" [ngClass]="getTypeClass(element.type)">
                            {{ element.type }}
                        </span>
                    </td>
                </ng-container>

                <!-- Coluna Descrição -->
                <ng-container matColumnDef="description">
                    <th mat-header-cell *matHeaderCellDef class="text-left"> DESCRIÇÃO </th>
                    <td mat-cell *matCellDef="let element" class="py-3 px-4 text-gray-800"> {{element.description}} </td>
                </ng-container>

                <!-- Coluna Ações -->
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef class="text-center"> AÇÕES </th>
                    <td mat-cell *matCellDef="let element" class="py-1 px-4 text-center">
                        <button type="button" class="btn-icon edit-icon" (click)="openEventDialog(element)" aria-label="Editar Evento" matTooltip="Editar Evento" matTooltipPosition="above">
                            <mat-icon>edit</mat-icon>
                        </button>
                        <button type="button" class="btn-icon delete-icon" (click)="deleteEvent(element.id)" aria-label="Excluir Evento" matTooltip="Excluir Evento" matTooltipPosition="above">
                            <mat-icon>delete_outline</mat-icon>
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                <tr mat-row *matRowDef="let _row; columns: displayedColumns;" class="hover:bg-gray-50 transition-colors"></tr>
            </table>

            <div *ngIf="dataSource.data.length === 0" class="text-center text-gray-500 dark:text-gray-400 py-8">
                Nenhum evento registrado para este incidente ainda.
            </div>
        </div>
    </div>
</div>
